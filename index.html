<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MIS Executive Assessment - Google Sheets & Systems Implementation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
            text-align: center;
        }

        .header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.2em;
        }

        .header h2 {
            color: #34495e;
            margin-bottom: 15px;
            font-weight: normal;
        }

        .instruction {
            background: #e8f4fd;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #3498db;
            margin-bottom: 20px;
        }

        .candidate-info {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .candidate-info input {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            border: 2px solid #bdc3c7;
            border-radius: 5px;
            font-size: 1em;
        }

        .test-container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .progress-bar {
            background: #ecf0f1;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            margin: 20px 30px;
        }

        .progress-fill {
            background: linear-gradient(90deg, #3498db, #2ecc71);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
        }

        .section-header {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 20px 30px;
            font-size: 1.3em;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .question-container {
            padding: 30px;
            border-bottom: 1px solid #ecf0f1;
        }

        .question-container:last-child {
            border-bottom: none;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }

        .question-number {
            background: #3498db;
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-weight: bold;
            margin-right: 15px;
            min-width: 40px;
            text-align: center;
        }

        .question-title {
            flex: 1;
            font-size: 1.1em;
            font-weight: 600;
            color: #2c3e50;
        }

        .points {
            background: #e74c3c;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.9em;
            font-weight: bold;
            margin-left: 10px;
        }

        .question-content {
            margin-left: 55px;
        }

        .answer-area {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            font-family: inherit;
            font-size: 1em;
            resize: vertical;
            margin-top: 15px;
            transition: border-color 0.3s ease;
        }

        .answer-area:focus {
            border-color: #3498db;
            outline: none;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            padding: 30px;
            background: #f8f9fa;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
            transform: translateY(-2px);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        .hidden {
            display: none;
        }

        .timer {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(44, 62, 80, 0.9);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 1.1em;
            z-index: 1000;
        }

        .results-container {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-top: 30px;
        }

        .results-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .total-score {
            font-size: 3em;
            font-weight: bold;
            color: #2c3e50;
            margin: 20px 0;
        }

        .grade-badge {
            display: inline-block;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.2em;
            font-weight: bold;
            margin: 10px 0;
        }

        .exceptional { background: #d4edda; color: #155724; }
        .strong { background: #cce5ff; color: #004085; }
        .qualified { background: #fff3cd; color: #856404; }
        .acceptable { background: #f8d7da; color: #721c24; }
        .not-recommended { background: #f5c6cb; color: #721c24; }

        .section-scores {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .section-score {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border-left: 4px solid #3498db;
        }

        .section-score h3 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .section-score .score {
            font-size: 2em;
            font-weight: bold;
            color: #3498db;
        }

        .detailed-results {
            margin-top: 30px;
        }

        .question-result {
            background: #f8f9fa;
            padding: 20px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #bdc3c7;
        }

        .question-result.correct {
            border-left-color: #27ae60;
            background: #d5f4e6;
        }

        .question-result.partial {
            border-left-color: #f39c12;
            background: #fef9e7;
        }

        .question-result.incorrect {
            border-left-color: #e74c3c;
            background: #fadbd8;
        }

        .recommendation {
            background: #e8f4fd;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #3498db;
            margin-top: 30px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .question-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .question-number {
                margin-bottom: 10px;
            }
            
            .question-content {
                margin-left: 0;
            }
            
            .timer {
                position: static;
                margin-bottom: 20px;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="timer" id="timer">Time: 00:00</div>
    
    <div class="container">
        <!-- Candidate Information -->
        <div class="candidate-info" id="candidateInfo">
            <h3>Candidate Information</h3>
            <input type="text" id="candidateName" placeholder="Full Name" required>
            <input type="email" id="candidateEmail" placeholder="Email Address" required>
            <input type="text" id="candidatePhone" placeholder="Phone Number" required>
            <input type="text" id="candidateExperience" placeholder="Years of Experience with Google Sheets" required>
            <button class="btn btn-primary" onclick="startAssessment()">Start Assessment</button>
        </div>

        <!-- Assessment Header -->
        <div class="header hidden" id="assessmentHeader">
            <h1>MIS Executive Assessment</h1>
            <h2>Google Sheets & Systems Implementation Focus</h2>
            <div class="instruction">
                <strong>Instructions:</strong> Please answer all questions thoughtfully. You have 60 minutes to complete this assessment. Provide specific examples where requested. Your responses will be automatically evaluated upon submission.
            </div>
        </div>

        <!-- Assessment Form -->
        <div class="test-container hidden" id="assessmentForm">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>

            <!-- Section A: Technical Proficiency -->
            <div class="section" id="section-a">
                <div class="section-header">
                    <span>Section A: Technical Proficiency</span>
                    <span>(40 points)</span>
                </div>

                <!-- Q1 -->
                <div class="question-container">
                    <div class="question-header">
                        <div style="display: flex; align-items: center;">
                            <span class="question-number">Q1</span>
                            <span class="question-title">How do you stay updated with new Google Sheets features and formulas?</span>
                        </div>
                        <span class="points">5 pts</span>
                    </div>
                    <div class="question-content">
                        <textarea class="answer-area" placeholder="Please provide specific resources, websites, or methods you use to stay current with Google Sheets updates..." data-question="q1" data-points="5"></textarea>
                    </div>
                </div>

                <!-- Q2 -->
                <div class="question-container">
                    <div class="question-header">
                        <div style="display: flex; align-items: center;">
                            <span class="question-number">Q2</span>
                            <span class="question-title">Explain the difference between VLOOKUP and INDEX(MATCH). When would you choose one over the other?</span>
                        </div>
                        <span class="points">5 pts</span>
                    </div>
                    <div class="question-content">
                        <textarea class="answer-area" placeholder="Explain the differences and provide scenarios where each function is most appropriate..." data-question="q2" data-points="5"></textarea>
                    </div>
                </div>

                <!-- Q3 -->
                <div class="question-container">
                    <div class="question-header">
                        <div style="display: flex; align-items: center;">
                            <span class="question-number">Q3</span>
                            <span class="question-title">Write a formula to find total sales for "North" region where amount is above ₹50,000</span>
                        </div>
                        <span class="points">5 pts</span>
                    </div>
                    <div class="question-content">
                        <p><strong>Context:</strong> Sales data with columns: Date, Product, Region, Salesperson, Amount</p>
                        <textarea class="answer-area" placeholder="Write the exact formula you would use..." data-question="q3" data-points="5"></textarea>
                    </div>
                </div>

                <!-- Q4 -->
                <div class="question-container">
                    <div class="question-header">
                        <div style="display: flex; align-items: center;">
                            <span class="question-number">Q4</span>
                            <span class="question-title">Explain how you would use COUNTIF to identify duplicates in a column</span>
                        </div>
                        <span class="points">5 pts</span>
                    </div>
                    <div class="question-content">
                        <textarea class="answer-area" placeholder="Provide the formula and explain how it works to identify duplicates..." data-question="q4" data-points="5"></textarea>
                    </div>
                </div>

                <!-- Q5 -->
                <div class="question-container">
                    <div class="question-header">
                        <div style="display: flex; align-items: center;">
                            <span class="question-number">Q5</span>
                            <span class="question-title">Name at least 3 unique features in Google Sheets not available in Excel</span>
                        </div>
                        <span class="points">5 pts</span>
                    </div>
                    <div class="question-content">
                        <textarea class="answer-area" placeholder="List and briefly explain at least 3 unique Google Sheets features..." data-question="q5" data-points="5"></textarea>
                    </div>
                </div>

                <!-- Q6 -->
                <div class="question-container">
                    <div class="question-header">
                        <div style="display: flex; align-items: center;">
                            <span class="question-number">Q6</span>
                            <span class="question-title">Write an IF statement that categorizes sales: Below ₹10,000 as "Low", ₹10,000-₹50,000 as "Medium", above ₹50,000 as "High"</span>
                        </div>
                        <span class="points">5 pts</span>
                    </div>
                    <div class="question-content">
                        <textarea class="answer-area" placeholder="Write the complete IF formula..." data-question="q6" data-points="5"></textarea>
                    </div>
                </div>

                <!-- Q7 -->
                <div class="question-container">
                    <div class="question-header">
                        <div style="display: flex; align-items: center;">
                            <span class="question-number">Q7</span>
                            <span class="question-title">How would you create a dynamic dropdown list that updates automatically when source data changes?</span>
                        </div>
                        <span class="points">5 pts</span>
                    </div>
                    <div class="question-content">
                        <textarea class="answer-area" placeholder="Explain the step-by-step process to create a dynamic dropdown..." data-question="q7" data-points="5"></textarea>
                    </div>
                </div>

                <!-- Q8 -->
                <div class="question-container">
                    <div class="question-header">
                        <div style="display: flex; align-items: center;">
                            <span class="question-number">Q8</span>
                            <span class="question-title">Explain ARRAYFORMULA and provide a practical example</span>
                        </div>
                        <span class="points">5 pts</span>
                    </div>
                    <div class="question-content">
                        <textarea class="answer-area" placeholder="Explain what ARRAYFORMULA does and provide a working example..." data-question="q8" data-points="5"></textarea>
                    </div>
                </div>
            </div>

            <!-- Section B: Systems Thinking -->
            <div class="section hidden" id="section-b">
                <div class="section-header">
                    <span>Section B: Systems Thinking & Problem Solving</span>
                    <span>(30 points)</span>
                </div>

                <!-- Q9 -->
                <div class="question-container">
                    <div class="question-header">
                        <div style="display: flex; align-items: center;">
                            <span class="question-number">Q9</span>
                            <span class="question-title">A company currently maintains 5 different Excel files for inventory across departments. How would you consolidate this into a single Google Sheets system?</span>
                        </div>
                        <span class="points">10 pts</span>
                    </div>
                    <div class="question-content">
                        <textarea class="answer-area" placeholder="Provide a detailed plan including assessment, design, implementation, and change management..." data-question="q9" data-points="10"></textarea>
                    </div>
                </div>

                <!-- Q10 -->
                <div class="question-container">
                    <div class="question-header">
                        <div style="display: flex; align-items: center;">
                            <span class="question-number">Q10</span>
                            <span class="question-title">Your colleague says "This formula isn't working" - walk me through your troubleshooting approach</span>
                        </div>
                        <span class="points">5 pts</span>
                    </div>
                    <div class="question-content">
                        <textarea class="answer-area" placeholder="Describe your step-by-step troubleshooting methodology..." data-question="q10" data-points="5"></textarea>
                    </div>
                </div>

                <!-- Q11 -->
                <div class="question-container">
                    <div class="question-header">
                        <div style="display: flex; align-items: center;">
                            <span class="question-number">Q11</span>
                            <span class="question-title">How would you automate a weekly report that pulls data from multiple sheets and emails it to management?</span>
                        </div>
                        <span class="points">10 pts</span>
                    </div>
                    <div class="question-content">
                        <textarea class="answer-area" placeholder="Explain your automation approach, tools, and implementation strategy..." data-question="q11" data-points="10"></textarea>
                    </div>
                </div>

                <!-- Q12 -->
                <div class="question-container">
                    <div class="question-header">
                        <div style="display: flex; align-items: center;">
                            <span class="question-number">Q12</span>
                            <span class="question-title">Describe a situation where you identified an inefficient process and improved it. What was your approach?</span>
                        </div>
                        <span class="points">5 pts</span>
                    </div>
                    <div class="question-content">
                        <textarea class="answer-area" placeholder="Provide a specific example with problem identification, solution, and measurable results..." data-question="q12" data-points="5"></textarea>
                    </div>
                </div>
            </div>

            <!-- Section C: Learning Ability -->
            <div class="section hidden" id="section-c">
                <div class="section-header">
                    <span>Section C: Learning Ability & Adaptability</span>
                    <span>(15 points)</span>
                </div>

                <!-- Q13 -->
                <div class="question-container">
                    <div class="question-header">
                        <div style="display: flex; align-items: center;">
                            <span class="question-number">Q13</span>
                            <span class="question-title">Google Sheets just released a new function you've never used. How would you learn it quickly?</span>
                        </div>
                        <span class="points">5 pts</span>
                    </div>
                    <div class="question-content">
                        <textarea class="answer-area" placeholder="Describe your learning methodology and resources..." data-question="q13" data-points="5"></textarea>
                    </div>
                </div>

                <!-- Q14 -->
                <div class="question-container">
                    <div class="question-header">
                        <div style="display: flex; align-items: center;">
                            <span class="question-number">Q14</span>
                            <span class="question-title">Tell me about the last technical skill you learned on your own. How long did it take?</span>
                        </div>
                        <span class="points">5 pts</span>
                    </div>
                    <div class="question-content">
                        <textarea class="answer-area" placeholder="Provide a recent example with timeline and application..." data-question="q14" data-points="5"></textarea>
                    </div>
                </div>

                <!-- Q15 -->
                <div class="question-container">
                    <div class="question-header">
                        <div style="display: flex; align-items: center;">
                            <span class="question-number">Q15</span>
                            <span class="question-title">How would you train a team member who is resistant to switching from Excel to Google Sheets?</span>
                        </div>
                        <span class="points">5 pts</span>
                    </div>
                    <div class="question-content">
                        <textarea class="answer-area" placeholder="Describe your training approach and change management strategy..." data-question="q15" data-points="5"></textarea>
                    </div>
                </div>
            </div>

            <!-- Section D: Practical Assessment -->
            <div class="section hidden" id="section-d">
                <div class="section-header">
                    <span>Section D: Practical Assessment</span>
                    <span>(15 points)</span>
                </div>

                <!-- Q16 -->
                <div class="question-container">
                    <div class="question-header">
                        <div style="display: flex; align-items: center;">
                            <span class="question-number">Q16</span>
                            <span class="question-title">Design a basic sales dashboard structure for a small business. List the components and formulas you'd use.</span>
                        </div>
                        <span class="points">15 pts</span>
                    </div>
                    <div class="question-content">
                        <textarea class="answer-area" placeholder="Describe dashboard components, key metrics, formulas, and user-friendly design elements..." data-question="q16" data-points="15"></textarea>
                    </div>
                </div>
            </div>

            <div class="navigation">
                <button class="btn btn-secondary" id="prevBtn" onclick="previousSection()" disabled>Previous</button>
                <button class="btn btn-primary" id="nextBtn" onclick="nextSection()">Next Section</button>
            </div>
        </div>

        <!-- Results Container -->
        <div class="results-container hidden" id="resultsContainer">
            <div class="results-header">
                <h2>Assessment Results</h2>
                <div class="total-score" id="totalScore">0/100</div>
                <div class="grade-badge" id="gradeBadge">Loading...</div>
            </div>

            <div class="section-scores" id="sectionScores">
                <!-- Section scores will be populated here -->
            </div>

            <div class="recommendation" id="recommendation">
                <!-- Recommendation will be populated here -->
            </div>

            <div class="detailed-results" id="detailedResults">
                <!-- Detailed question-by-question results will be populated here -->
            </div>
        </div>
    </div>

    <script>
        let currentSection = 0;
        let startTime = Date.now();
        let timerInterval;
        let candidateData = {};
        let answers = {};

        // Scoring keywords and criteria
        const scoringCriteria = {
            q1: {
                keywords: ['google workspace updates', 'youtube', 'blog', 'official', 'specific', 'ben collins', 'google sheets', 'workspace'],
                maxScore: 5,
                evaluate: (answer) => {
                    const lower = answer.toLowerCase();
                    let score = 0;
                    if (lower.includes('google workspace') || lower.includes('official') || lower.includes('blog')) score += 2;
                    if (lower.includes('youtube') || lower.includes('specific') || lower.includes('channel')) score += 2;
                    if (lower.includes('recent') || lower.includes('update') || lower.includes('new')) score += 1;
                    return Math.min(score, 5);
                }
            },
            q2: {
                keywords: ['index', 'match', 'flexible', 'direction', 'performance', 'vlookup', 'left', 'right'],
                maxScore: 5,
                evaluate: (answer) => {
                    const lower = answer.toLowerCase();
                    let score = 0;
                    if (lower.includes('index') && lower.includes('match')) score += 2;
                    if (lower.includes('flexible') || lower.includes('direction') || lower.includes('left')) score += 2;
                    if (lower.includes('performance') || lower.includes('faster') || lower.includes('efficient')) score += 1;
                    return Math.min(score, 5);
                }
            },
            q3: {
                keywords: ['sumifs', 'sumif', 'north', '50000', 'criteria'],
                maxScore: 5,
                evaluate: (answer) => {
                    const lower = answer.toLowerCase();
                    let score = 0;
                    if (lower.includes('sumifs') || lower.includes('sumif')) score += 3;
                    if (lower.includes('north') && lower.includes('50000')) score += 2;
                    return Math.min(score, 5);
                }
            },
            q4: {
                keywords: ['countif', 'duplicate', 'greater than 1', '>1', 'absolute', 'relative'],
                maxScore: 5,
                evaluate: (answer) => {
                    const lower = answer.toLowerCase();
                    let score = 0;
                    if (lower.includes('countif')) score += 2;
                    if (lower.includes('>1') || lower.includes('greater than 1') || lower.includes('more than 1')) score += 2;
                    if (lower.includes('absolute') || lower.includes('$')) score += 1;
                    return Math.min(score, 5);
                }
            },
            q5: {
                keywords: ['googlefinance', 'importrange', 'collaboration', 'query', 'arrayformula', 'forms', 'real-time'],
                maxScore: 5,
                evaluate: (answer) => {
                    const lower = answer.toLowerCase();
                    const features = ['googlefinance', 'importrange', 'collaboration', 'query', 'arrayformula', 'forms'];
                    let count = 0;
                    features.forEach(feature => {
                        if (lower.includes(feature) || (feature === 'collaboration' && lower.includes('real-time'))) count++;
                    });
                    return Math.min(count + (count >= 3 ? 2 : 0), 5);
                }
            },
            q6: {
                keywords: ['if', 'nested', 'ifs', '10000', '50000', 'low', 'medium', 'high'],
                maxScore: 5,
                evaluate: (answer) => {
                    const lower = answer.toLowerCase();
                    let score = 0;
                    if (lower.includes('if(') || lower.includes('ifs(')) score += 2;
                    if (lower.includes('10000') && lower.includes('50000')) score += 2;
                    if (lower.includes('low') && lower.includes('medium') && lower.includes('high')) score += 1;
                    return Math.min(score, 5);
                }
            },
            q7: {
                keywords: ['data validation', 'dynamic', 'range', 'unique', 'named range'],
                maxScore: 5,
                evaluate: (answer) => {
                    const lower = answer.toLowerCase();
                    let score = 0;
                    if (lower.includes('data validation')) score += 2;
                    if (lower.includes('dynamic') || lower.includes('automatic')) score += 2;
                    if (lower.includes('unique') || lower.includes('named range')) score += 1;
                    return Math.min(score, 5);
                }
            },
            q8: {
                keywords: ['arrayformula', 'array', 'multiple', 'entire', 'column', 'range'],
                maxScore: 5,
                evaluate: (answer) => {
                    const lower = answer.toLowerCase();
                    let score = 0;
                    if (lower.includes('arrayformula')) score += 2;
                    if (lower.includes('array') && (lower.includes('multiple') || lower.includes('entire'))) score += 2;
                    if (lower.includes('example') && (lower.includes('*') || lower.includes('formula'))) score += 1;
                    return Math.min(score, 5);
                }
            },
            q9: {
                keywords: ['consolidation', 'importrange', 'assessment', 'design', 'implementation', 'training', 'access control', 'backup'],
                maxScore: 10,
                evaluate: (answer) => {
                    const lower = answer.toLowerCase();
                    let score = 0;
                    if (lower.includes('assessment') || lower.includes('analyze')) score += 2;
                    if (lower.includes('importrange') || lower.includes('consolidat')) score += 3;
                    if (lower.includes('training') || lower.includes('change management')) score += 2;
                    if (lower.includes('access') || lower.includes('permission') || lower.includes('backup')) score += 2;
                    if (lower.includes('step') || lower.includes('phase') || lower.includes('plan')) score += 1;
                    return Math.min(score, 10);
                }
            },
            q10: {
                keywords: ['debug', 'troubleshoot', 'systematic', 'error', 'step by step', 'ref', 'value', 'na'],
                maxScore: 5,
                evaluate: (answer) => {
                    const lower = answer.toLowerCase();
                    let score = 0;
                    if (lower.includes('systematic') || lower.includes('step by step')) score += 2;
                    if (lower.includes('error') && (lower.includes('ref') || lower.includes('value') || lower.includes('na'))) score += 2;
                    if (lower.includes('teach') || lower.includes('explain') || lower.includes('patient')) score += 1;
                    return Math.min(score, 5);
                }
            },
            q11: {
                keywords: ['apps script', 'automation', 'schedule', 'trigger', 'email', 'importrange', 'pivot'],
                maxScore: 10,
                evaluate: (answer) => {
                    const lower = answer.toLowerCase();
                    let score = 0;
                    if (lower.includes('apps script') || lower.includes('google apps script')) score += 4;
                    if (lower.includes('automat') || lower.includes('schedul')) score += 2;
                    if (lower.includes('email') || lower.includes('send')) score += 2;
                    if (lower.includes('importrange') || lower.includes('pivot') || lower.includes('addon')) score += 2;
                    return Math.min(score, 10);
                }
            },
            q12: {
                keywords: ['specific', 'problem', 'solution', 'improvement', 'measurable', 'time', 'efficiency'],
                maxScore: 5,
                evaluate: (answer) => {
                    const lower = answer.toLowerCase();
                    let score = 0;
                    if (lower.includes('specific') || lower.length > 100) score += 1;
                    if (lower.includes('problem') && lower.includes('solution')) score += 2;
                    if (lower.includes('improv') || lower.includes('better') || lower.includes('faster')) score += 1;
                    if (lower.includes('measur') || lower.includes('time') || lower.includes('efficiency')) score += 1;
                    return Math.min(score, 5);
                }
            },
            q13: {
                keywords: ['documentation', 'practice', 'test', 'example', 'video', 'community', 'forum'],
                maxScore: 5,
                evaluate: (answer) => {
                    const lower = answer.toLowerCase();
                    let score = 0;
                    if (lower.includes('document') || lower.includes('official')) score += 1;
                    if (lower.includes('practice') || lower.includes('test') || lower.includes('example')) score += 2;
                    if (lower.includes('video') || lower.includes('tutorial')) score += 1;
                    if (lower.includes('community') || lower.includes('forum') || lower.includes('help')) score += 1;
                    return Math.min(score, 5);
                }
            },
            q14: {
                keywords: ['recent', 'specific', 'timeline', 'application', 'self-learning', 'motivation'],
                maxScore: 5,
                evaluate: (answer) => {
                    const lower = answer.toLowerCase();
                    let score = 0;
                    if (lower.includes('recent') || lower.includes('last') || lower.includes('month') || lower.includes('year')) score += 1;
                    if (lower.length > 80 && (lower.includes('learn') || lower.includes('skill'))) score += 2;
                    if (lower.includes('took') || lower.includes('time') || lower.includes('week') || lower.includes('day')) score += 1;
                    if (lower.includes('apply') || lower.includes('use') || lower.includes('implement')) score += 1;
                    return Math.min(score, 5);
                }
            },
            q15: {
                keywords: ['empathy', 'patience', 'benefit', 'gradual', 'hands-on', 'support', 'resistance'],
                maxScore: 5,
                evaluate: (answer) => {
                    const lower = answer.toLowerCase();
                    let score = 0;
                    if (lower.includes('empathy') || lower.includes('understand') || lower.includes('patient')) score += 1;
                    if (lower.includes('benefit') || lower.includes('advantage') || lower.includes('better')) score += 2;
                    if (lower.includes('gradual') || lower.includes('step') || lower.includes('slowly')) score += 1;
                    if (lower.includes('hands-on') || lower.includes('practice') || lower.includes('support')) score += 1;
                    return Math.min(score, 5);
                }
            },
            q16: {
                keywords: ['dashboard', 'metrics', 'chart', 'pivot', 'kpi', 'sales', 'design', 'user-friendly'],
                maxScore: 15,
                evaluate: (answer) => {
                    const lower = answer.toLowerCase();
                    let score = 0;
                    if (lower.includes('dashboard') || lower.includes('visual')) score += 2;
                    if (lower.includes('metric') || lower.includes('kpi') || lower.includes('key performance')) score += 3;
                    if (lower.includes('chart') || lower.includes('graph') || lower.includes('pivot')) score += 3;
                    if (lower.includes('total sales') || lower.includes('revenue') || lower.includes('growth')) score += 2;
                    if (lower.includes('user') || lower.includes('design') || lower.includes('clean')) score += 2;
                    if (lower.includes('formula') || lower.includes('sum') || lower.includes('average')) score += 2;
                    if (lower.includes('date') || lower.includes('filter') || lower.includes('dynamic')) score += 1;
                    return Math.min(score, 15);
                }
            }
        };

        function startAssessment() {
            const name = document.getElementById('candidateName').value;
            const email = document.getElementById('candidateEmail').value;
            const phone = document.getElementById('candidatePhone').value;
            const experience = document.getElementById('candidateExperience').value;

            if (!name || !email || !phone || !experience) {
                alert('Please fill in all candidate information fields.');
                return;
            }

            candidateData = { name, email, phone, experience };
            
            document.getElementById('candidateInfo').classList.add('hidden');
            document.getElementById('assessmentHeader').classList.remove('hidden');
            document.getElementById('assessmentForm').classList.remove('hidden');
            
            startTimer();
            updateProgress();
        }

        function startTimer() {
            startTime = Date.now();
            timerInterval = setInterval(updateTimer, 1000);
        }

        function updateTimer() {
            const elapsed = Math.floor((Date.now() - startTime) / 1000);
            const minutes = Math.floor(elapsed / 60);
            const seconds = elapsed % 60;
            document.getElementById('timer').textContent = 
                `Time: ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // Auto-submit after 60 minutes
            if (minutes >= 60) {
                submitAssessment();
            }
        }

        function updateProgress() {
            const totalSections = 4;
            const progress = ((currentSection + 1) / totalSections) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function nextSection() {
            const sections = ['section-a', 'section-b', 'section-c', 'section-d'];
            
            if (currentSection < sections.length - 1) {
                document.getElementById(sections[currentSection]).classList.add('hidden');
                currentSection++;
                document.getElementById(sections[currentSection]).classList.remove('hidden');
                updateProgress();
                
                document.getElementById('prevBtn').disabled = false;
                
                if (currentSection === sections.length - 1) {
                    document.getElementById('nextBtn').textContent = 'Submit Assessment';
                    document.getElementById('nextBtn').onclick = submitAssessment;
                }
            }
        }

        function previousSection() {
            const sections = ['section-a', 'section-b', 'section-c', 'section-d'];
            
            if (currentSection > 0) {
                document.getElementById(sections[currentSection]).classList.add('hidden');
                currentSection--;
                document.getElementById(sections[currentSection]).classList.remove('hidden');
                updateProgress();
                
                if (currentSection === 0) {
                    document.getElementById('prevBtn').disabled = true;
                }
                
                if (currentSection < sections.length - 1) {
                    document.getElementById('nextBtn').textContent = 'Next Section';
                    document.getElementById('nextBtn').onclick = nextSection;
                }
            }
        }

        function submitAssessment() {
            clearInterval(timerInterval);
            
            // Collect all answers
            const textareas = document.querySelectorAll('.answer-area');
            textareas.forEach(textarea => {
                const questionId = textarea.getAttribute('data-question');
                answers[questionId] = textarea.value.trim();
            });
            
            // Calculate scores
            const results = calculateScores();
            
            // Hide assessment form and show results
            document.getElementById('assessmentForm').classList.add('hidden');
            displayResults(results);
        }

        function calculateScores() {
            let totalScore = 0;
            let sectionScores = {
                'Technical Proficiency': { score: 0, maxScore: 40 },
                'Systems Thinking': { score: 0, maxScore: 30 },
                'Learning Ability': { score: 0, maxScore: 15 },
                'Practical Assessment': { score: 0, maxScore: 15 }
            };
            let questionResults = {};

            // Technical Proficiency (Q1-Q8)
            for (let i = 1; i <= 8; i++) {
                const questionId = `q${i}`;
                const answer = answers[questionId] || '';
                const score = scoringCriteria[questionId] ? scoringCriteria[questionId].evaluate(answer) : 0;
                sectionScores['Technical Proficiency'].score += score;
                totalScore += score;
                questionResults[questionId] = {
                    score: score,
                    maxScore: scoringCriteria[questionId]?.maxScore || 5,
                    answer: answer
                };
            }

            // Systems Thinking (Q9-Q12)
            for (let i = 9; i <= 12; i++) {
                const questionId = `q${i}`;
                const answer = answers[questionId] || '';
                const score = scoringCriteria[questionId] ? scoringCriteria[questionId].evaluate(answer) : 0;
                sectionScores['Systems Thinking'].score += score;
                totalScore += score;
                questionResults[questionId] = {
                    score: score,
                    maxScore: scoringCriteria[questionId]?.maxScore || 5,
                    answer: answer
                };
            }

            // Learning Ability (Q13-Q15)
            for (let i = 13; i <= 15; i++) {
                const questionId = `q${i}`;
                const answer = answers[questionId] || '';
                const score = scoringCriteria[questionId] ? scoringCriteria[questionId].evaluate(answer) : 0;
                sectionScores['Learning Ability'].score += score;
                totalScore += score;
                questionResults[questionId] = {
                    score: score,
                    maxScore: scoringCriteria[questionId]?.maxScore || 5,
                    answer: answer
                };
            }

            // Practical Assessment (Q16)
            const q16Answer = answers['q16'] || '';
            const q16Score = scoringCriteria['q16'] ? scoringCriteria['q16'].evaluate(q16Answer) : 0;
            sectionScores['Practical Assessment'].score += q16Score;
            totalScore += q16Score;
            questionResults['q16'] = {
                score: q16Score,
                maxScore: 15,
                answer: q16Answer
            };

            return {
                totalScore,
                sectionScores,
                questionResults,
                candidateData
            };
        }

        function displayResults(results) {
            document.getElementById('resultsContainer').classList.remove('hidden');
            
            // Display total score
            document.getElementById('totalScore').textContent = `${results.totalScore}/100`;
            
            // Determine grade
            let grade, gradeClass, recommendation;
            if (results.totalScore >= 90) {
                grade = 'Exceptional';
                gradeClass = 'exceptional';
                recommendation = 'Ready for senior/lead roles. Excellent hire with immediate contribution potential.';
            } else if (results.totalScore >= 75) {
                grade = 'Strong';
                gradeClass = 'strong';
                recommendation = 'Excellent hire, ready to contribute immediately with minimal training required.';
            } else if (results.totalScore >= 60) {
                grade = 'Qualified';
                gradeClass = 'qualified';
                recommendation = 'Good candidate, may need minimal training but shows solid foundation.';
            } else if (results.totalScore >= 50) {
                grade = 'Acceptable';
                gradeClass = 'acceptable';
                recommendation = 'Meets basic requirements, needs development but has potential.';
            } else {
                grade = 'Not Recommended';
                gradeClass = 'not-recommended';
                recommendation = 'Significant skill gaps present. Consider for junior role with extensive training.';
            }
            
            const gradeBadge = document.getElementById('gradeBadge');
            gradeBadge.textContent = grade;
            gradeBadge.className = `grade-badge ${gradeClass}`;
            
            // Display section scores
            const sectionScoresContainer = document.getElementById('sectionScores');
            sectionScoresContainer.innerHTML = '';
            
            Object.entries(results.sectionScores).forEach(([sectionName, sectionData]) => {
                const percentage = Math.round((sectionData.score / sectionData.maxScore) * 100);
                const sectionCard = document.createElement('div');
                sectionCard.className = 'section-score';
                sectionCard.innerHTML = `
                    <h3>${sectionName}</h3>
                    <div class="score">${sectionData.score}/${sectionData.maxScore}</div>
                    <div>(${percentage}%)</div>
                `;
                sectionScoresContainer.appendChild(sectionCard);
            });
            
            // Display recommendation
            document.getElementById('recommendation').innerHTML = `
                <h3>Hiring Recommendation</h3>
                <p><strong>${recommendation}</strong></p>
                <p><strong>Candidate:</strong> ${results.candidateData.name} (${results.candidateData.experience} years experience)</p>
            `;
            
            // Display detailed results
            const detailedContainer = document.getElementById('detailedResults');
            detailedContainer.innerHTML = '<h3>Detailed Question Analysis</h3>';
            
            const questionTitles = {
                q1: 'Staying Updated with Google Sheets',
                q2: 'VLOOKUP vs INDEX(MATCH)',
                q3: 'SUMIFS Formula Implementation',
                q4: 'COUNTIF for Duplicate Detection',
                q5: 'Google Sheets Unique Features',
                q6: 'Nested IF Statements',
                q7: 'Dynamic Dropdown Lists',
                q8: 'ARRAYFORMULA Usage',
                q9: 'System Consolidation Strategy',
                q10: 'Troubleshooting Approach',
                q11: 'Report Automation',
                q12: 'Process Improvement Example',
                q13: 'Learning New Functions',
                q14: 'Self-Learning Example',
                q15: 'Training Resistant Users',
                q16: 'Dashboard Design'
            };
            
            Object.entries(results.questionResults).forEach(([questionId, questionData]) => {
                const percentage = Math.round((questionData.score / questionData.maxScore) * 100);
                let resultClass = 'incorrect';
                if (percentage >= 80) resultClass = 'correct';
                else if (percentage >= 50) resultClass = 'partial';
                
                const questionDiv = document.createElement('div');
                questionDiv.className = `question-result ${resultClass}`;
                questionDiv.innerHTML = `
                    <h4>${questionTitles[questionId]} - ${questionData.score}/${questionData.maxScore} (${percentage}%)</h4>
                    <p><strong>Answer:</strong> ${questionData.answer || 'No answer provided'}</p>
                `;
                detailedContainer.appendChild(questionDiv);
            });
            
            // Generate downloadable report
            generateReport(results);
        }

        function generateReport(results) {
            const reportData = {
                candidate: results.candidateData,
                assessment: {
                    date: new Date().toISOString(),
                    totalScore: results.totalScore,
                    grade: document.getElementById('gradeBadge').textContent,
                    sectionScores: results.sectionScores,
                    questionResults: results.questionResults
                }
            };
            
            const reportJson = JSON.stringify(reportData, null, 2);
            const blob = new Blob([reportJson], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const downloadLink = document.createElement('a');
            downloadLink.href = url;
            downloadLink.download = `MIS_Assessment_${results.candidateData.name.replace(/\s+/g, '_')}_${new Date().toISOString().split('T')[0]}.json`;
            downloadLink.textContent = 'Download Detailed Report (JSON)';
            downloadLink.className = 'btn btn-secondary';
            downloadLink.style.marginTop = '20px';
            downloadLink.style.display = 'block';
            
            document.getElementById('recommendation').appendChild(downloadLink);
        }

        // Initialize the assessment
        document.addEventListener('DOMContentLoaded', function() {
            updateProgress();
        });
    </script>
</body>
</html>
